<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="theme-color" content="#0b0f14" />
  <meta property="og:title" content="BROKE ‚Üí BOSS Button" />
  <meta property="og:description" content="–ñ–º–∏ –∫–Ω–æ–ø–∫—É. –ü–æ–ª—É—á–∞–π –º–∏—Å—Å–∏—é –Ω–∞ 24 —á–∞—Å–∞. –û—Ç—á—ë—Ç ‚Äî –≤ 1 –∫–ª–∏–∫." />
  <title>BROKE ‚Üí BOSS Button</title>

  <style>
    :root{
      --bg:#0b0f14;
      --panel: rgba(255,255,255,.06);
      --panel2: rgba(255,255,255,.04);
      --stroke: rgba(255,255,255,.10);
      --text: rgba(255,255,255,.92);
      --muted: rgba(255,255,255,.65);
      --muted2: rgba(255,255,255,.45);
      --good: #48ffb8;
      --bad:  #ff4d6d;
      --hot:  #ffb86b;
      --cold: #7aa8ff;
      --glow: 0 0 40px rgba(122,168,255,.22), 0 0 70px rgba(72,255,184,.12);
      --radius: 26px;
      --shadow: 0 18px 70px rgba(0,0,0,.55);
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
    }

    *{ box-sizing: border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      background:
        radial-gradient(900px 600px at 15% 10%, rgba(122,168,255,.14), transparent 55%),
        radial-gradient(900px 600px at 85% 20%, rgba(72,255,184,.10), transparent 55%),
        radial-gradient(900px 700px at 50% 95%, rgba(255,184,107,.10), transparent 60%),
        linear-gradient(180deg, #070a0f 0%, #0b0f14 40%, #070a0f 100%);
      color: var(--text);
      font-family: var(--sans);
      overflow-x: hidden;
    }

    .noise::before{
      content:"";
      position: fixed; inset:0;
      pointer-events:none;
      background-image:
        url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='180' height='180'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.8' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='180' height='180' filter='url(%23n)' opacity='.22'/%3E%3C/svg%3E");
      mix-blend-mode: overlay;
      opacity:.35;
    }

    .wrap{
      max-width: 1100px;
      margin: 0 auto;
      padding: 28px 18px 90px;
      position: relative;
    }

    header{
      display:flex;
      align-items:flex-start;
      justify-content: space-between;
      gap: 18px;
      margin-top: 8px;
      margin-bottom: 18px;
    }

    .brand{
      display:flex; gap:14px; align-items:flex-start;
    }

    .logo{
      width: 46px; height: 46px;
      border-radius: 16px;
      background:
        radial-gradient(18px 18px at 30% 30%, rgba(255,255,255,.32), transparent 60%),
        linear-gradient(135deg, rgba(72,255,184,.90), rgba(122,168,255,.88), rgba(255,184,107,.90));
      box-shadow: var(--glow);
      position: relative;
      overflow:hidden;
      border: 1px solid rgba(255,255,255,.18);
    }
    .logo::after{
      content:"";
      position:absolute; inset:-40%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,.35), transparent);
      transform: rotate(25deg);
      animation: sweep 3.2s linear infinite;
    }
    @keyframes sweep{
      0%{ transform: translateX(-40%) rotate(25deg); opacity: .0;}
      15%{ opacity:.9;}
      50%{ opacity:.0;}
      100%{ transform: translateX(60%) rotate(25deg); opacity:0;}
    }

    .title{
      line-height:1.05;
    }
    .title h1{
      margin:0;
      font-size: clamp(28px, 4.6vw, 44px);
      letter-spacing: -0.03em;
    }
    .title p{
      margin:10px 0 0;
      color: var(--muted);
      max-width: 640px;
    }

    .top-actions{
      display:flex;
      gap:10px;
      align-items:center;
      flex-wrap: wrap;
      justify-content: flex-end;
    }

    .pill{
      display:flex; gap:10px; align-items:center;
      padding: 10px 12px;
      border-radius: 999px;
      background: rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.10);
      box-shadow: 0 10px 30px rgba(0,0,0,.28);
      color: var(--muted);
      font-size: 13px;
      user-select:none;
    }

    .pill b{ color: var(--text); font-weight: 600; }
    .dot{
      width:8px; height:8px; border-radius:99px;
      background: var(--good);
      box-shadow: 0 0 18px rgba(72,255,184,.45);
    }

    main{
      display:grid;
      grid-template-columns: 1.1fr .9fr;
      gap: 16px;
      align-items:start;
    }

    @media (max-width: 920px){
      main{ grid-template-columns: 1fr; }
    }

    .card{
      background: linear-gradient(180deg, var(--panel), var(--panel2));
      border: 1px solid rgba(255,255,255,.10);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
      position: relative;
    }

    .card::before{
      content:"";
      position:absolute; inset:0;
      pointer-events:none;
      background:
        radial-gradient(400px 220px at 20% 10%, rgba(72,255,184,.10), transparent 60%),
        radial-gradient(360px 220px at 80% 0%, rgba(122,168,255,.12), transparent 60%),
        radial-gradient(500px 260px at 50% 110%, rgba(255,184,107,.09), transparent 60%);
      opacity:.9;
    }

    .card .inner{
      position: relative;
      padding: 18px;
    }

    .subhead{
      display:flex;
      justify-content: space-between;
      align-items:center;
      gap: 12px;
      margin-bottom: 12px;
    }
    .subhead h2{
      margin: 0;
      font-size: 16px;
      letter-spacing: .02em;
      color: rgba(255,255,255,.86);
      font-weight: 650;
    }

    .badge{
      font-family: var(--mono);
      font-size: 12px;
      padding: 7px 10px;
      border-radius: 999px;
      background: rgba(0,0,0,.28);
      border: 1px solid rgba(255,255,255,.12);
      color: rgba(255,255,255,.78);
      display:flex;
      gap:8px;
      align-items:center;
    }

    .btn-row{
      display:flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 14px;
    }

    button{
      appearance:none;
      border:0;
      cursor:pointer;
      border-radius: 16px;
      padding: 12px 14px;
      font-weight: 700;
      letter-spacing: -.01em;
      color: rgba(255,255,255,.92);
      background: rgba(255,255,255,.08);
      border: 1px solid rgba(255,255,255,.12);
      box-shadow: 0 14px 40px rgba(0,0,0,.35);
      transition: transform .15s ease, background .15s ease, border-color .15s ease;
    }
    button:hover{ transform: translateY(-1px); background: rgba(255,255,255,.10); border-color: rgba(255,255,255,.16);}
    button:active{ transform: translateY(1px) scale(.99);}

    .primary{
      background: linear-gradient(135deg, rgba(72,255,184,.88), rgba(122,168,255,.82), rgba(255,184,107,.85));
      border-color: rgba(255,255,255,.18);
      box-shadow: var(--glow), 0 18px 60px rgba(0,0,0,.45);
      color: rgba(0,0,0,.82);
    }

    .danger{
      background: rgba(255,77,109,.14);
      border-color: rgba(255,77,109,.28);
      color: rgba(255,255,255,.92);
    }

    .ghost{
      background: transparent;
      border: 1px dashed rgba(255,255,255,.22);
      color: rgba(255,255,255,.85);
      box-shadow: none;
    }

    .grid2{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
    }
    @media (max-width: 520px){
      .grid2{ grid-template-columns: 1fr; }
    }

    .control{
      display:flex;
      flex-direction: column;
      gap: 8px;
      padding: 12px;
      border-radius: 18px;
      background: rgba(0,0,0,.18);
      border: 1px solid rgba(255,255,255,.10);
    }
    label{
      font-size: 12px;
      color: var(--muted);
    }
    select,input[type="range"],input[type="text"],textarea{
      width: 100%;
      border-radius: 14px;
      padding: 10px 12px;
      background: rgba(255,255,255,.08);
      border: 1px solid rgba(255,255,255,.10);
      color: rgba(255,255,255,.92);
      outline: none;
      font-family: var(--sans);
    }
    textarea{ min-height: 92px; resize: vertical; }

    .big{
      font-size: clamp(18px, 2.2vw, 22px);
      letter-spacing: -.02em;
      line-height: 1.25;
      margin: 0 0 10px;
    }

    .muted{ color: var(--muted); }
    .muted2{ color: var(--muted2); }

    .missionTitle{
      margin: 0;
      font-size: clamp(18px, 2.1vw, 24px);
      letter-spacing: -.02em;
      line-height: 1.2;
    }

    .meta{
      display:flex;
      gap:10px;
      flex-wrap: wrap;
      margin-top: 10px;
      margin-bottom: 12px;
    }

    .chip{
      font-family: var(--mono);
      font-size: 12px;
      padding: 7px 10px;
      border-radius: 999px;
      background: rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.12);
      color: rgba(255,255,255,.80);
      display:flex;
      gap:8px; align-items:center;
    }

    .progress{
      margin-top: 12px;
      padding: 12px;
      border-radius: 18px;
      background: rgba(0,0,0,.18);
      border: 1px solid rgba(255,255,255,.10);
    }
    .bar{
      height: 12px;
      border-radius: 999px;
      background: rgba(255,255,255,.08);
      border: 1px solid rgba(255,255,255,.10);
      overflow:hidden;
      margin-top: 8px;
    }
    .fill{
      height:100%;
      width: 0%;
      background: linear-gradient(90deg, rgba(72,255,184,.92), rgba(122,168,255,.86), rgba(255,184,107,.92));
      box-shadow: var(--glow);
      transition: width .25s ease;
    }

    .checklist{
      display:flex; flex-direction:column;
      gap: 10px;
      margin-top: 14px;
    }
    .item{
      display:flex; gap:10px; align-items:flex-start;
      padding: 12px;
      border-radius: 18px;
      background: rgba(255,255,255,.06);
      border: 1px solid rgba(255,255,255,.10);
    }
    .item input{ margin-top: 3px; transform: scale(1.2); }
    .item b{ display:block; margin-bottom: 4px; }
    .item small{ color: var(--muted); display:block; line-height:1.35; }

    .timer{
      display:flex;
      gap: 12px;
      align-items: center;
      justify-content: space-between;
      padding: 12px 12px;
      border-radius: 18px;
      background: rgba(0,0,0,.20);
      border: 1px solid rgba(255,255,255,.10);
      margin-top: 14px;
    }
    .timer .t{
      font-family: var(--mono);
      font-size: 16px;
      letter-spacing: .02em;
    }

    .toast{
      position: fixed;
      left: 50%;
      bottom: 18px;
      transform: translateX(-50%);
      padding: 12px 14px;
      border-radius: 999px;
      background: rgba(0,0,0,.60);
      border: 1px solid rgba(255,255,255,.16);
      color: rgba(255,255,255,.88);
      font-size: 13px;
      box-shadow: 0 18px 70px rgba(0,0,0,.45);
      opacity: 0;
      pointer-events:none;
      transition: opacity .2s ease, transform .2s ease;
      z-index: 50;
    }
    .toast.show{
      opacity: 1;
      transform: translateX(-50%) translateY(-6px);
    }

    .kicker{
      font-family: var(--mono);
      letter-spacing: .06em;
      text-transform: uppercase;
      font-size: 11px;
      color: rgba(255,255,255,.62);
      margin: 0 0 6px;
    }

    .divider{
      height:1px;
      background: rgba(255,255,255,.10);
      margin: 14px 0;
    }

    .small-actions{
      display:flex;
      gap: 10px;
      flex-wrap: wrap;
      margin-top: 10px;
    }

    .canvasWrap{
      margin-top: 12px;
      border-radius: 18px;
      overflow:hidden;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.18);
    }
    canvas{
      width: 100%;
      height: auto;
      display:block;
    }

    .footer{
      margin-top: 18px;
      color: rgba(255,255,255,.55);
      font-size: 12px;
      text-align:center;
    }

    .spark{
      display:inline-block;
      width:10px; height:10px;
      border-radius: 99px;
      background: rgba(72,255,184,.92);
      box-shadow: 0 0 22px rgba(72,255,184,.50);
      margin-right: 8px;
      transform: translateY(1px);
    }
  </style>
</head>

<body class="noise">
  <div class="wrap">
    <header>
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <div class="title">
          <h1>BROKE ‚Üí BOSS Button</h1>
          <p>
            –ñ–º–∏ –∫–Ω–æ–ø–∫—É ‚Äî –ø–æ–ª—É—á–∞–π <b>–º–∏—Å—Å–∏—é –Ω–∞ 24 —á–∞—Å–∞</b>. –°–¥–µ–ª–∞–π —Ö–æ—Ç—å —á—Ç–æ-—Ç–æ —Ä–µ–∞–ª—å–Ω–æ–µ.
            –í –∫–æ–Ω—Ü–µ ‚Äî <b>–æ—Ç—á—ë—Ç + –ø–æ—Å—Ç –¥–ª—è —Å–æ—Ü—Å–µ—Ç–µ–π</b> –≤ 1 –∫–ª–∏–∫. –ö—Ä–∞—Å–∏–≤–æ. –°–º–µ—à–Ω–æ. –ë–æ–ª—å–Ω–æ –ø—Ä–∞–≤–¥–∏–≤–æ.
          </p>
        </div>
      </div>

      <div class="top-actions">
        <div class="pill"><span class="dot"></span><span>—Ä–µ–∂–∏–º: <b id="modeLabel">SAFE CHAOS</b></span></div>
        <div class="pill"><span>—Å—Ç–∞—Ç—É—Å: <b id="statusLabel">–≥–æ—Ç–æ–≤ –∫ –Ω–∞–∂–∞—Ç–∏—é</b></span></div>
      </div>
    </header>

    <main>
      <!-- LEFT: Mission -->
      <section class="card">
        <div class="inner">
          <div class="subhead">
            <h2>üéõÔ∏è –ü—É–ª—å—Ç —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏</h2>
            <div class="badge"><span class="spark"></span><span id="bossName">BOSS: ???</span></div>
          </div>

          <div class="grid2">
            <div class="control">
              <label>–†–µ–∂–∏–º</label>
              <select id="mode">
                <option value="safe">SAFE CHAOS (–±–µ–∑–æ–ø–∞—Å–Ω–æ, –Ω–æ –¥–µ—Ä–∑–∫–æ)</option>
                <option value="hard">HARD MODE (–∂—ë—Å—Ç–∫–æ, –Ω–æ –ª–µ–≥–∞–ª—å–Ω–æ)</option>
                <option value="meme">MEME LORD (–º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —Å–º–µ—à–Ω–æ)</option>
              </select>
            </div>

            <div class="control">
              <label>–¢–µ–º–∞ –º–∏—Å—Å–∏–π</label>
              <select id="theme">
                <option value="mixed">–°–º–µ—à–∞–Ω–Ω—ã–π —Ö–∞–æ—Å</option>
                <option value="money">–î–µ–Ω—å–≥–∏</option>
                <option value="skills">–ù–∞–≤—ã–∫</option>
                <option value="health">–¢–µ–ª–æ</option>
                <option value="social">–°–æ—Ü–∏–∞–ª–∫–∞</option>
                <option value="clean">–ü–æ—Ä—è–¥–æ–∫</option>
                <option value="creator">–ö–æ–Ω—Ç–µ–Ω—Ç</option>
              </select>
            </div>

            <div class="control">
              <label>–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å</label>
              <select id="duration">
                <option value="24">24 —á–∞—Å–∞ (–∫–∞–Ω–æ–Ω)</option>
                <option value="6">6 —á–∞—Å–æ–≤ (—É—Å–∫–æ—Ä–∏—Ç–µ–ª—å)</option>
                <option value="1">1 —á–∞—Å (–¥–æ–ø–∞–º–∏–Ω-—Ç–µ—Å—Ç)</option>
              </select>
            </div>

            <div class="control">
              <label>–°–∞–±–æ—Ç–∞–∂-—Ñ–∏–ª—å—Ç—Ä (–º–µ–Ω—å—à–µ –∫—Ä–∏–Ω–∂–∞) ‚Äî <span id="cringeLabel">35%</span></label>
              <input id="cringe" type="range" min="0" max="100" value="35" />
            </div>
          </div>

          <div class="btn-row">
            <button class="primary" id="btnGenerate">–ñ–ú–ò. –î–ê–ô –ú–ù–ï –ú–ò–°–°–ò–Æ</button>
            <button id="btnStart">–ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–∞–π–º–µ—Ä</button>
            <button class="ghost" id="btnReroll">–†–µ—Ä–æ–ª–ª (–µ—Å–ª–∏ –≤—ã–ø–∞–ª –∫—Ä–∏–Ω–∂)</button>
            <button class="danger" id="btnReset">–°–±—Ä–æ—Å–∏—Ç—å –≤—Å—ë</button>
          </div>

          <div class="divider"></div>

          <p class="kicker">–¢–≤–æ—è –º–∏—Å—Å–∏—è</p>
          <h3 class="missionTitle" id="mTitle">–ü–æ–∫–∞ –ø—É—Å—Ç–æ. –ù–∞–∂–º–∏ –∫–Ω–æ–ø–∫—É.</h3>
          <p class="muted" id="mHook">–°–∞–π—Ç –Ω–µ –±—É–¥–µ—Ç —Ç–µ–±—è –≤–¥–æ—Ö–Ω–æ–≤–ª—è—Ç—å. –û–Ω –±—É–¥–µ—Ç —Ç–µ–±—è —Ç–æ–ª–∫–∞—Ç—å.</p>

          <div class="meta" id="metaRow" style="display:none;">
            <div class="chip">‚è±Ô∏è <span id="mEta">‚Äî</span></div>
            <div class="chip">üéØ <span id="mDifficulty">‚Äî</span></div>
            <div class="chip">üìå –î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ: <span id="mProof">‚Äî</span></div>
            <div class="chip">üß™ ‚Äú–†–µ–∞–ª—å–Ω–æ—Å—Ç—å‚Äù: <span id="mReality">‚Äî</span></div>
          </div>

          <div class="timer" id="timerBox" style="display:none;">
            <div>
              <div class="muted2" style="font-size:12px;">–¥–æ –∫–æ–Ω—Ü–∞ –æ—Å—Ç–∞–ª–æ—Å—å</div>
              <div class="t" id="timeLeft">‚Äî:‚Äî:‚Äî</div>
            </div>
            <div class="chip">‚ö° Boss Points: <span id="points">0</span></div>
          </div>

          <div class="progress" id="progressBox" style="display:none;">
            <div style="display:flex;justify-content:space-between;gap:10px;align-items:center;">
              <div class="muted2" id="progressText">0/0 –≤—ã–ø–æ–ª–Ω–µ–Ω–æ</div>
              <div class="muted2" id="roastLine">‚Äî</div>
            </div>
            <div class="bar"><div class="fill" id="fill"></div></div>

            <div class="checklist" id="checklist"></div>

            <div class="small-actions">
              <button id="btnReport">–°–≥–µ–Ω–µ—Ä–∏—Ç—å –æ—Ç—á—ë—Ç/–ø–æ—Å—Ç</button>
              <button id="btnShare">–®—ç—Ä-–∫–∞—Ä—Ç–æ—á–∫–∞</button>
              <button class="ghost" id="btnCopyLink">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É</button>
            </div>

            <div class="canvasWrap" id="canvasWrap" style="display:none;">
              <canvas id="shareCanvas" width="1200" height="630"></canvas>
            </div>

            <div class="footer">
              <span class="spark"></span> –í–∞–∂–Ω–æ: —Ç—É—Ç –Ω–µ—Ç —Å–µ—Ä–≤–µ—Ä–∞. –í—Å—ë —Ö—Ä–∞–Ω–∏—Ç—Å—è —É —Ç–µ–±—è –≤ –±—Ä–∞—É–∑–µ—Ä–µ.
            </div>
          </div>
        </div>
      </section>

      <!-- RIGHT: Report / Post -->
      <aside class="card">
        <div class="inner">
          <div class="subhead">
            <h2>üßæ –û—Ç—á—ë—Ç –∏ –≤–∏—Ä—É—Å-–ø–æ—Å—Ç</h2>
            <div class="badge"><span>OG-–∫–∞—Ä—Ç–æ—á–∫–∞ –≥–æ—Ç–æ–≤–∏—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ</span></div>
          </div>

          <p class="big">
            –°–¥–µ–ª–∞–ª –º–∏—Å—Å–∏—é? –ù–µ –º–æ–ª—á–∏. <b>–°–¥–µ–ª–∞–π –∏–∑ —ç—Ç–æ–≥–æ –ø–æ—Å—Ç</b>.
            –ò–Ω—Ç–µ—Ä–Ω–µ—Ç –ª—é–±–∏—Ç –Ω–µ ‚Äú–º–æ—Ç–∏–≤–∞—Ü–∏—é‚Äù, –∞ <b>–¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ</b>.
          </p>

          <div class="control">
            <label>–ß—Ç–æ —Ç—ã —Ä–µ–∞–ª—å–Ω–æ —Å–¥–µ–ª–∞–ª? (–∫–æ—Ä–æ—Ç–∫–æ –∏ –±–µ–∑ –≥–µ—Ä–æ–∏–∑–º–∞)</label>
            <textarea id="doneText" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: —Å–¥–µ–ª–∞–ª 30 –º–∏–Ω—É—Ç, –ø–æ—Ç–æ–º —Ö–æ—Ç–µ–ª —Å–¥–∞—Ç—å—Å—è, –Ω–æ –¥–æ–±–∏–ª."></textarea>
          </div>

          <div class="grid2" style="margin-top:10px;">
            <div class="control">
              <label>–†–µ–∑—É–ª—å—Ç–∞—Ç (—Ü–∏—Ñ—Ä–∞/—Ñ–∞–∫—Ç)</label>
              <input id="resultText" type="text" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: +1 –≤–∏–¥–µ–æ / 12 –∑–∞—è–≤–æ–∫ / 45 –º–∏–Ω—É—Ç" />
            </div>
            <div class="control">
              <label>–£—Ä–æ–≤–µ–Ω—å –±–æ–ª–∏ (—á–µ—Å—Ç–Ω–æ)</label>
              <select id="pain">
                <option>üôÇ –ª–µ–≥–∫–æ—Ç–Ω—è</option>
                <option>üòê –Ω–µ–ø—Ä–∏—è—Ç–Ω–æ, –Ω–æ –Ω–æ—Ä–º</option>
                <option>üò§ —Ç—è–∂–µ–ª–æ</option>
                <option>ü•µ –ø–æ—á—Ç–∏ —Å–¥–æ—Ö</option>
              </select>
            </div>
          </div>

          <div class="divider"></div>

          <div class="control">
            <label>–ì–æ—Ç–æ–≤—ã–π –ø–æ—Å—Ç (Twitter/Threads/Telegram)</label>
            <textarea id="postOut" readonly></textarea>
          </div>

          <div class="btn-row">
            <button class="primary" id="btnMakePost">–°–æ–±—Ä–∞—Ç—å –ø–æ—Å—Ç</button>
            <button id="btnCopyPost">–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
            <button class="ghost" id="btnMakeInsult">–°–¥–µ–ª–∞–π –ø–æ—Å—Ç —Å–º–µ—à–Ω–µ–µ</button>
          </div>

          <div class="divider"></div>

          <p class="muted" style="margin:0;">
            üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞: –≤ –∫–æ–Ω—Ü–µ –º–∏—Å—Å–∏–∏ –≤—ã–∫–ª–∞–¥—ã–≤–∞–π —à—ç—Ä-–∫–∞—Ä—Ç–æ—á–∫—É (–∫–Ω–æ–ø–∫–∞ —Å–ª–µ–≤–∞).
            –≠—Ç–æ –∏ –µ—Å—Ç—å –≤–∏—Ä—É—Å–Ω—ã–π ‚Äú–ø—Ä—É—Ñ‚Äù.
          </p>
        </div>
      </aside>
    </main>
  </div>

  <div class="toast" id="toast">ok</div>

  <script>
    // =========================
    // BROKE ‚Üí BOSS (Single-file)
    // =========================

    const $ = (id) => document.getElementById(id);

    const STORAGE_KEY = "b2b_state_v1";
    const now = () => Date.now();

    const bossNames = [
      "–ê–Ω—Ç–∏-–ü—Ä–æ–∫—Ä–∞—Å—Ç–∏–Ω–∞—Ç–æ—Ä",
      "–ö–æ–º–∞–Ω–¥–∏—Ä –ü—Ä—É—Ñ–æ–≤",
      "–ì–µ–Ω–µ—Ä–∞–ª –î–∏—Å—Ü–∏–ø–ª–∏–Ω—ã",
      "–ö–∞–ø–∏—Ç–∞–Ω 1%",
      "–ì–æ—Å–ø–æ–¥–∏–Ω '–©–∞—Å-—Å–¥–µ–ª–∞—é'",
      "–õ–æ—Ä–¥ –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏",
      "–†–µ–∂–∏—Å—Å—ë—Ä –†–µ–∞–ª—å–Ω–æ—Å—Ç–∏",
      "–®–µ—Ñ –ë–µ–∑ –û—Ç–º–∞–∑–æ–∫",
      "–ú–∞—Å—Ç–µ—Ä –ú–∞–ª—ã—Ö –ü–æ–±–µ–¥",
      "–ò–º–ø–µ—Ä–∞—Ç–æ—Ä –ú–∏–Ω–∏-–î–µ–π—Å—Ç–≤–∏–π"
    ];

    // Mission bank: –¥–ª—è –æ–±—ã—á–Ω—ã—Ö –ª—é–¥–µ–π, –Ω–æ —Å –º–µ–º–Ω—ã–º –≤–∞–π–±–æ–º.
    // –ö–∞–∂–¥–∞—è –º–∏—Å—Å–∏—è = –∫–æ—Ä–æ—Ç–∫–∏–π –∫–≤–µ—Å—Ç + –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ.
    const MISSIONS = [
      // MONEY
      {
        id:"money-1", theme:"money", difficulty: "–°—Ä–µ–¥–Ω–µ-–Ω–∞–≥–ª–æ",
        title:"–°–¥–µ–ª–∞–π 1‚Ç¨ –∏–∑ –≤–æ–∑–¥—É—Ö–∞ (–ª–µ–≥–∞–ª—å–Ω–æ) ‚Äî —Å–µ–≥–æ–¥–Ω—è.",
        hook:"–î–∞, —ç—Ç–æ —Å–º–µ—à–Ω–æ. –ù–æ —Ç—ã –ª–∏–±–æ —É–º–µ–µ—à—å –¥–æ–±—ã–≤–∞—Ç—å –¥–µ–Ω—å–≥–∏, –ª–∏–±–æ —É–º–µ–µ—à—å –º–µ—á—Ç–∞—Ç—å. –í—ã–±–∏—Ä–∞–π.",
        reality:"–î–µ–Ω—å–≥–∏ –ª—é–±—è—Ç –¥–µ–π—Å—Ç–≤–∏–µ, –Ω–µ –∏–¥–µ–∏.",
        eta:"45‚Äì120 –º–∏–Ω",
        proof:"—Å–∫—Ä–∏–Ω/—Ñ–æ—Ç–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ (—á–µ–∫/–æ–±—ä—è–≤–ª–µ–Ω–∏–µ/–ø–µ—Ä–µ–≤–æ–¥)",
        steps:[
          {t:"–û—Ç–∫—Ä–æ–π local marketplace (willhaben / facebook / kleinanzeigen).", d:"–ù–∞–π–¥–∏ –≤–µ—â—å, –∫–æ—Ç–æ—Ä—É—é –º–æ–∂–Ω–æ –æ—Ç–¥–∞—Ç—å/–ø—Ä–æ–¥–∞—Ç—å –±—ã—Å—Ç—Ä–æ (–¥–∞–∂–µ –∑–∞ 1‚Äì5‚Ç¨)."},
          {t:"–°–¥–µ–ª–∞–π 2 —Ñ–æ—Ç–æ –∏ –∫–æ—Ä–æ—Ç–∫–æ–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ.", d:"–ë–µ–∑ —Ä–æ–º–∞–Ω–æ–≤. –¶–µ–Ω–∞ –º–∞–ª–µ–Ω—å–∫–∞—è. –¶–µ–ª—å ‚Äî —Å–∫–æ—Ä–æ—Å—Ç—å."},
          {t:"–û—Ç–ø—Ä–∞–≤—å 10 —Å–æ–æ–±—â–µ–Ω–∏–π/–æ—Ç–≤–µ—Ç—å 10 –ª—é–¥—è–º.", d:"–°–∫–æ—Ä–æ—Å—Ç—å –≤–∞–∂–Ω–µ–µ –≥–æ—Ä–¥–æ—Å—Ç–∏."},
          {t:"–ó–∞–∫—Ä–æ–π —Å–¥–µ–ª–∫—É –∏–ª–∏ –ø–æ—Å—Ç–∞–≤—å –≤—Å—Ç—Ä–µ—á—É –Ω–∞ –∑–∞–≤—Ç—Ä–∞.", d:"–ï—Å–ª–∏ –Ω–µ –ø—Ä–æ–¥–∞–ª ‚Äî —Å—á–∏—Ç–∞–µ–º –∫–∞–∫ –ø–æ–±–µ–¥—É: –Ω–∞–∑–Ω–∞—á–µ–Ω–Ω–∞—è –≤—Å—Ç—Ä–µ—á–∞ = —É—Å–ø–µ—Ö."}
        ],
        roast:[
          "–ï—Å–ª–∏ —Ç—ã —Å–µ–π—á–∞—Å –Ω–µ —Å–¥–µ–ª–∞–µ—à—å ‚Äî –∑–∞–≤—Ç—Ä–∞ –æ–ø—è—Ç—å –±—É–¥–µ—à—å ‚Äò–≥–æ—Ç–æ–≤–∏—Ç—å—Å—è‚Äô.",
          "–ò–¥–µ—è –±–µ–∑ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ ‚Äî —ç—Ç–æ —Å–æ–Ω –≤ –æ–±–µ–¥.",
          "–°–º–µ–ª–æ—Å—Ç—å = 10 —Å–æ–æ–±—â–µ–Ω–∏–π –Ω–µ–∑–Ω–∞–∫–æ–º—ã–º –ª—é–¥—è–º."
        ]
      },
      {
        id:"money-2", theme:"money", difficulty:"–ñ—ë—Å—Ç–∫–æ-–ø—Ä–∞–∫—Ç–∏—á–Ω–æ",
        title:"–°–æ–±–µ—Ä–∏ '–º–∏–Ω–∏-–ø—Ä–æ–¥—É–∫—Ç' –∑–∞ 60 –º–∏–Ω—É—Ç –∏ –≤—ã—Å—Ç–∞–≤—å —Ü–µ–Ω—É.",
        hook:"–ù–µ –±–∏–∑–Ω–µ—Å. –ú–∏–Ω–∏-–ø—Ä–æ–¥—É–∫—Ç. –û–¥–∏–Ω. –ß—ë—Ç–∫–∏–π. –ë–µ–∑ —Å—Ç—ã–¥–∞.",
        reality:"–î–µ–ª–∞—é—Ç –Ω–µ –ª—É—á—à–∏–µ ‚Äî –¥–µ–ª–∞—é—Ç –±—ã—Å—Ç—Ä—ã–µ.",
        eta:"60‚Äì90 –º–∏–Ω",
        proof:"—Å—Å—ã–ª–∫–∞ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É/–ø–æ—Å—Ç —Å —Ü–µ–Ω–æ–π",
        steps:[
          {t:"–í—ã–±–µ—Ä–∏ 1 —É—Å–ª—É–≥—É, –∫–æ—Ç–æ—Ä—É—é —Ä–µ–∞–ª—å–Ω–æ –º–æ–∂–µ—à—å —Å–¥–µ–ª–∞—Ç—å.", d:"–ü—Ä–∏–º–µ—Ä: –º–æ–Ω—Ç–∞–∂ 15 —Å–µ–∫, –æ–∑–≤—É—á–∫–∞, –±–∞–Ω–Ω–µ—Ä, –ø–µ—Ä–µ–≤–æ–¥, –º–∏–Ω–∏-—Å–∞–π—Ç."},
          {t:"–°–¥–µ–ª–∞–π 1 –æ–±—Ä–∞–∑–µ—Ü (–¥–µ–º–æ).", d:"–î–∞–∂–µ –∫—Ä–∏–≤–æ–π. –ì–ª–∞–≤–Ω–æ–µ ‚Äî –ø–æ–∫–∞–∑–∞—Ç—å."},
          {t:"–ù–∞–ø–∏—à–∏ –æ—Ñ—Ñ–µ—Ä –≤ 2 —Å—Ç—Ä–æ–∫–∏ + —Ü–µ–Ω—É.", d:"–ù–∞–ø—Ä: ‚ÄúI‚Äôll edit your Short in 1 hour ‚Äî ‚Ç¨5.‚Äù"},
          {t:"–û–ø—É–±–ª–∏–∫—É–π (X/Reddit/Discord/Telegram/FB group).", d:"–ü—Ä—É—Ñ ‚Äî —Å—Å—ã–ª–∫–∞. –¢–æ—á–∫–∞."}
        ],
        roast:[
          "–¢—ã –Ω–µ –±–µ–¥–Ω—ã–π. –¢—ã –Ω–µ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–ª.",
          "–ï—Å–ª–∏ –Ω–µ—Ç —Ü–µ–Ω—ã ‚Äî —ç—Ç–æ –Ω–µ –ø—Ä–æ–¥—É–∫—Ç, –∞ —Ñ–∞–Ω—Ç–∞–∑–∏—è.",
          "–î–µ–º–æ —Ä–µ—à–∞–µ—Ç 100%."
        ]
      },

      // SKILLS
      {
        id:"skills-1", theme:"skills", difficulty:"–£–º–Ω–æ-–ø—Ä–æ—Ç–∏–≤–Ω–æ",
        title:"–í—ã—É—á–∏ 20 —Å–ª–æ–≤/—Ç–µ—Ä–º–∏–Ω–æ–≤ ‚Äî –Ω–æ —Ç–∞–∫, —á—Ç–æ–±—ã –æ–Ω–∏ –ø—Ä–∏–ª–∏–ø–ª–∏.",
        hook:"–ù–µ ‚Äò–ø—Ä–æ—á–∏—Ç–∞–ª‚Äô. –ê —á—Ç–æ–±—ã –∑–∞–≤—Ç—Ä–∞ –º–æ–≥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å. –ò–Ω–∞—á–µ —ç—Ç–æ –º—É—Å–æ—Ä –≤ –≥–æ–ª–æ–≤–µ.",
        reality:"–ú–æ–∑–≥ —É–≤–∞–∂–∞–µ—Ç –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ –∏ –±–æ–ª—å.",
        eta:"30‚Äì45 –º–∏–Ω",
        proof:"—Å–∫—Ä–∏–Ω —Å–ø–∏—Å–∫–∞ + 5 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π —Å –Ω–∏–º–∏",
        steps:[
          {t:"–í—ã–±–µ—Ä–∏ —Ç–µ–º—É (–∞–Ω–≥–ª/–∫–æ–¥/—Ä–∞–±–æ—Ç–∞).", d:"–û–¥–Ω—É. –ù–µ 7."},
          {t:"–í—ã–ø–∏—à–∏ 20 —Å–ª–æ–≤ + –ø–µ—Ä–µ–≤–æ–¥.", d:"–°–¥–µ–ª–∞–π —ç—Ç–æ –±—ã—Å—Ç—Ä–æ."},
          {t:"–°–æ—Å—Ç–∞–≤—å 5 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π, –∏—Å–ø–æ–ª—å–∑—É—è —Å–ª–æ–≤–∞.", d:"–ß—Ç–æ–±—ã –º–æ–∑–≥ –ø–æ–Ω—è–ª: —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ –∑–≤—É–∫–∏."},
          {t:"–ü—Ä–æ–∏–∑–Ω–µ—Å–∏ –≤—Å–ª—É—Ö 2 –º–∏–Ω—É—Ç—ã.", d:"–î–∞, –≤—Å–ª—É—Ö. –î–∞, —Å—Ç—Ä–∞–Ω–Ω–æ. –î–∞, —Ä–∞–±–æ—Ç–∞–µ—Ç."}
        ],
        roast:[
          "–ß–∏—Ç–∞—Ç—å = –ø—Ä–∏—è—Ç–Ω–æ. –£—á–∏—Ç—å = –Ω–µ–ø—Ä–∏—è—Ç–Ω–æ. –ü–æ—ç—Ç–æ–º—É –≤—ã–∏–≥—Ä—ã–≤–∞—é—Ç –Ω–µ–ø—Ä–∏—è—Ç–Ω—ã–µ.",
          "–°–ª–æ–≤–∞ –±–µ–∑ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π ‚Äî —ç—Ç–æ –∫–æ–ª–ª–µ–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ö–ª–∞–º–∞.",
          "2 –º–∏–Ω—É—Ç—ã –≤—Å–ª—É—Ö —Ä–µ—à–∞—é—Ç."
        ]
      },
      {
        id:"skills-2", theme:"skills", difficulty:"–•–∞–∫–µ—Ä—Å–∫–∏-—Ä–µ–∞–ª—å–Ω–æ",
        title:"–°–¥–µ–ª–∞–π –º–∏–∫—Ä–æ-–ø—Ä–æ–µ–∫—Ç –∑–∞ 1 —á–∞—Å –∏ –≤—ã–ª–æ–∂–∏.",
        hook:"–¢–µ–±–µ –Ω—É–∂–µ–Ω –Ω–µ —Ç–∞–ª–∞–Ω—Ç. –¢–µ–±–µ –Ω—É–∂–µ–Ω GitHub —Å –∂–∏–∑–Ω—å—é.",
        reality:"–ü—É–±–ª–∏–∫–∞—Ü–∏—è = –≤–∑—Ä–æ—Å–ª–∞—è –∏–≥—Ä–∞.",
        eta:"60‚Äì90 –º–∏–Ω",
        proof:"—Å—Å—ã–ª–∫–∞ –Ω–∞ —Ä–µ–ø–æ/Pages",
        steps:[
          {t:"–í—ã–±–µ—Ä–∏ –º–∏–∫—Ä–æ-–∏–¥–µ—é.", d:"–ü—Ä–∏–º–µ—Ä: —Ç–∞–π–º–µ—Ä, —Ç—Ä–µ–∫–µ—Ä, –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä, –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä."},
          {t:"–°–¥–µ–ª–∞–π —Ä–∞–±–æ—á–∏–π MVP –≤ –æ–¥–Ω–æ–º —Ñ–∞–π–ª–µ.", d:"HTML/CSS/JS. –ì–ª–∞–≤–Ω–æ–µ ‚Äî —á—Ç–æ–±—ã —Ä–∞–±–æ—Ç–∞–ª–æ."},
          {t:"–ó–∞–ª–µ–π –Ω–∞ GitHub –∏ –≤–∫–ª—é—á–∏ Pages.", d:"–ü—Ä—É—Ñ ‚Äî —Å—Å—ã–ª–∫–∞."},
          {t:"–ù–∞–ø–∏—à–∏ 1 –∞–±–∑–∞—Ü README.", d:"–ß—Ç–æ —ç—Ç–æ –∏ –∑–∞—á–µ–º. –í—Å—ë."}
        ],
        roast:[
          "–ö–æ–¥ –±–µ–∑ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ ‚Äî —ç—Ç–æ –¥–Ω–µ–≤–Ω–∏–∫ –≤ —Å—Ç–æ–ª.",
          "–°–Ω–∞—á–∞–ª–∞ MVP. –ü–æ—Ç–æ–º —à–µ–¥–µ–≤—Ä.",
          "–í—ã–ª–æ–∂–∏–ª? –ó–Ω–∞—á–∏—Ç —Å—É—â–µ—Å—Ç–≤—É–µ—à—å."
        ]
      },

      // HEALTH
      {
        id:"health-1", theme:"health", difficulty:"–¢–µ—Ä–ø–∏–º–æ-–∂—ë—Å—Ç–∫–æ",
        title:"–°–¥–µ–ª–∞–π —Ç–µ–ª–æ –º–µ–Ω–µ–µ –∂–∞–ª–∫–∏–º –∑–∞ 12 –º–∏–Ω—É—Ç.",
        hook:"–ù–∏–∫–∞–∫–∏—Ö –º–∞—Ä–∞—Ñ–æ–Ω–æ–≤. 12 –º–∏–Ω—É—Ç. –°–µ–π—á–∞—Å. –ò —Ç–æ—á–∫–∞.",
        reality:"–¢–µ–ª–æ ‚Äî —ç—Ç–æ –∫–Ω–æ–ø–∫–∞ —ç–Ω–µ—Ä–≥–∏–∏. –ù–µ —Ñ–∏–ª–æ—Å–æ—Ñ–∏—è.",
        eta:"12‚Äì15 –º–∏–Ω",
        proof:"—Ç–∞–π–º–µ—Ä/—Å–µ–ª—Ñ–∏ –ø–æ—Å–ª–µ (–ø–æ –∂–µ–ª–∞–Ω–∏—é)",
        steps:[
          {t:"2 –º–∏–Ω—É—Ç—ã —Ä–∞–∑–º–∏–Ω–∫–∏.", d:"–®–µ—è, –ø–ª–µ—á–∏, –∫–æ–ª–µ–Ω–∏, –¥—ã—Ö–∞–Ω–∏–µ."},
          {t:"6 –º–∏–Ω—É—Ç –∫—Ä—É–≥: –ø—Ä–∏—Å–µ–¥/–æ—Ç–∂–∏–º/–ø–ª–∞–Ω–∫–∞.", d:"–ü–æ 30‚Äì45 —Å–µ–∫ –∫–∞–∂–¥—ã–π, 2 –∫—Ä—É–≥–∞."},
          {t:"2 –º–∏–Ω—É—Ç—ã —Ä–∞—Å—Ç—è–∂–∫–∞.", d:"–ß—Ç–æ–±—ã –Ω–µ —Ä–∞–∑–≤–∞–ª–∏—Ç—å—Å—è."},
          {t:"2 –º–∏–Ω—É—Ç—ã –≤–æ–¥–∞ + –∑–∞–ø–∏—Å—å –≤ –æ—Ç—á—ë—Ç.", d:"‚Äò–°–¥–µ–ª–∞–ª‚Äô. –í—Å—ë."}
        ],
        roast:[
          "–≠–Ω–µ—Ä–≥–∏—è –Ω–µ –ø—Ä–∏—Ö–æ–¥–∏—Ç. –ï—ë –¥–µ–ª–∞—é—Ç.",
          "12 –º–∏–Ω—É—Ç ‚Äî —ç—Ç–æ –Ω–µ —Å–ø–æ—Ä—Ç. –≠—Ç–æ —É–≤–∞–∂–µ–Ω–∏–µ –∫ —Å–µ–±–µ.",
          "–¢—ã —Ö–æ—Ç–µ–ª ‚Äò–º–æ—Ç–∏–≤–∞—Ü–∏—é‚Äô. –í–æ—Ç –æ–Ω–∞: —Å–¥–µ–ª–∞–π."
        ]
      },

      // SOCIAL
      {
        id:"social-1", theme:"social", difficulty:"–°—Ç—Ä–∞—à–Ω–æ-–ø–æ–ª–µ–∑–Ω–æ",
        title:"–ù–∞–ø–∏—à–∏ 10 –ª—é–¥—è–º. –ù–µ ‚Äò–ø—Ä–∏–≤–µ—Ç‚Äô. –ê –Ω–æ—Ä–º–∞–ª—å–Ω–æ.",
        hook:"–ö–æ–Ω—Ç–∞–∫—Ç—ã = —Ä–µ–∞–ª—å–Ω–æ—Å—Ç—å. –ú–æ–ª—á–∞–Ω–∏–µ = –±–æ–ª–æ—Ç–æ.",
        reality:"–°–æ—Ü–∏–∞–ª–∫–∞ ‚Äî —ç—Ç–æ –Ω–∞–≤—ã–∫, –∞ –Ω–µ —Å—É–¥—å–±–∞.",
        eta:"20‚Äì40 –º–∏–Ω",
        proof:"—Å–∫—Ä–∏–Ω —Å–ø–∏—Å–∫–∞ (–±–µ–∑ –ª–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö)",
        steps:[
          {t:"–°–æ—Å—Ç–∞–≤—å 1 —à–∞–±–ª–æ–Ω —Å–æ–æ–±—â–µ–Ω–∏—è.", d:"–ö–æ—Ä–æ—Ç–∫–æ: –∫—Ç–æ —Ç—ã + —á—Ç–æ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—à—å/—Å–ø—Ä–∞—à–∏–≤–∞–µ—à—å."},
          {t:"–û—Ç–ø—Ä–∞–≤—å 10 —Å–æ–æ–±—â–µ–Ω–∏–π.", d:"–†–∞–±–æ—Ç–∞/–∫–æ–ª–ª–∞–±/–ø—Ä–æ–¥–∞–∂–∞/–æ–±—â–µ–Ω–∏–µ ‚Äî –Ω–µ –≤–∞–∂–Ω–æ. –í–∞–∂–Ω–æ: 10."},
          {t:"–ó–∞–ø–∏—à–∏ –æ—Ç–≤–µ—Ç—ã/—Ç–∏—à–∏–Ω—É.", d:"–¢–∏—à–∏–Ω–∞ ‚Äî —Ç–æ–∂–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç."},
          {t:"–°–¥–µ–ª–∞–π 1 follow-up –∑–∞–≤—Ç—Ä–∞.", d:"–ü–ª–∞–Ω –Ω–∞ –∑–∞–≤—Ç—Ä–∞ = –≤–ª–∞—Å—Ç—å."}
        ],
        roast:[
          "–¢—ã –Ω–µ –∏–Ω—Ç—Ä–æ–≤–µ—Ä—Ç. –¢—ã –Ω–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∞–ª—Å—è.",
          "10 —Å–æ–æ–±—â–µ–Ω–∏–π ‚Äî —ç—Ç–æ 10 –¥–≤–µ—Ä–µ–π.",
          "–ö—Ç–æ –ø–∏—à–µ—Ç ‚Äî –ø–æ–ª—É—á–∞–µ—Ç."
        ]
      },

      // CLEAN
      {
        id:"clean-1", theme:"clean", difficulty:"–ü—Ä–æ—Å—Ç–æ-–≥–µ–Ω–∏–∞–ª—å–Ω–æ",
        title:"–£–Ω–∏—á—Ç–æ–∂—å 100 –≤–µ—â–µ–π-–º—É—Å–æ—Ä–∞ –∑–∞ 25 –º–∏–Ω—É—Ç.",
        hook:"–•–∞–æ—Å –≤ –∫–æ–º–Ω–∞—Ç–µ = —Ö–∞–æ—Å –≤ –≥–æ–ª–æ–≤–µ. –î–∞–≤–∞–π –±—ã—Å—Ç—Ä–æ.",
        reality:"–ü–æ—Ä—è–¥–æ–∫ ‚Äî —Å–∞–º—ã–π –¥–µ—à—ë–≤—ã–π –ø—Å–∏—Ö–æ–ª–æ–≥.",
        eta:"25‚Äì30 –º–∏–Ω",
        proof:"—Ñ–æ—Ç–æ ‚Äò–¥–æ/–ø–æ—Å–ª–µ‚Äô (–ø–æ –∂–µ–ª–∞–Ω–∏—é)",
        steps:[
          {t:"–ü–æ—Å—Ç–∞–≤—å —Ç–∞–π–º–µ—Ä –Ω–∞ 25 –º–∏–Ω—É—Ç.", d:"–ù–µ –¥—É–º–∞–π. –î–µ–ª–∞–π."},
          {t:"–°–æ–±–µ—Ä–∏ 1 –ø–∞–∫–µ—Ç –º—É—Å–æ—Ä–∞/–Ω–µ–Ω—É–∂–Ω–æ–≥–æ.", d:"–ë–µ–∑ —Ñ–∏–ª–æ—Å–æ—Ñ–∏–∏."},
          {t:"–£–±–µ—Ä–∏ 1 –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é.", d:"–°—Ç–æ–ª/–ø–æ–ª–∫–∞/—Ç—É–º–±–∞."},
          {t:"–û—Å—Ç–∞–Ω–æ–≤–∏—Å—å. –ó–∞–ø–∏—à–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç.", d:"–ü—Ä—É—Ñ: ‚Äò—Å–¥–µ–ª–∞–ª‚Äô."}
        ],
        roast:[
          "–¢—ã –Ω–µ —É—Å—Ç–∞–≤—à–∏–π. –¢—ã –æ–∫—Ä—É–∂—ë–Ω –º—É—Å–æ—Ä–æ–º.",
          "–ß–∏—Å—Ç–∞—è –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç—å = —á–∏—Å—Ç–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å.",
          "–ü–∞–∫–µ—Ç –º—É—Å–æ—Ä–∞ = –ø–æ–±–µ–¥–∞."
        ]
      },

      // CREATOR
      {
        id:"creator-1", theme:"creator", difficulty:"–í–∏—Ä—É—Å–Ω–æ-—Ä–µ–∞–ª—å–Ω–æ",
        title:"–°–¥–µ–ª–∞–π 1 Short (10‚Äì20 —Å–µ–∫) –∏ –≤—ã–ª–æ–∂–∏.",
        hook:"–¢—ã –Ω–µ ‚Äò–≥–æ—Ç–æ–≤–∏—à—å—Å—è‚Äô. –¢—ã –≤—ã–ø—É—Å–∫–∞–µ—à—å. –°–µ–≥–æ–¥–Ω—è.",
        reality:"–ö–æ–Ω—Ç–µ–Ω—Ç ‚Äî —ç—Ç–æ —Å–µ—Ä–∏—è. –ù–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ.",
        eta:"30‚Äì75 –º–∏–Ω",
        proof:"—Å—Å—ã–ª–∫–∞ –Ω–∞ –ø–æ—Å—Ç/—á–µ—Ä–Ω–æ–≤–∏–∫",
        steps:[
          {t:"–í—ã–±–µ—Ä–∏ 1 –º—ã—Å–ª—å/—Ñ–∞–∫—Ç.", d:"–û–¥–∏–Ω —É–¥–∞—Ä. –ù–µ –ª–µ–∫—Ü–∏—è."},
          {t:"–ó–∞–ø–∏—à–∏ –≥–æ–ª–æ—Å/—Ç–µ–∫—Å—Ç (10‚Äì20 —Å–µ–∫).", d:"–ü—Ä–æ—Å—Ç–æ. –ñ–∏–≤—ã–º —è–∑—ã–∫–æ–º."},
          {t:"–°–æ–±–µ—Ä–∏ –º–æ–Ω—Ç–∞–∂ –Ω–∞ –º–∏–Ω–∏–º–∞–ª–∫–∞—Ö.", d:"–û–¥–∏–Ω —Ñ–æ–Ω, –æ–¥–∏–Ω —Ç–µ–∫—Å—Ç, –æ–¥–Ω–∞ –º—É–∑—ã–∫–∞."},
          {t:"–í—ã–ª–æ–∂–∏ –∏–ª–∏ –ø–æ—Å—Ç–∞–≤—å –ø—É–±–ª–∏–∫–∞—Ü–∏—é.", d:"–ü—Ä—É—Ñ ‚Äî —Å—Å—ã–ª–∫–∞/—Å–∫—Ä–∏–Ω."}
        ],
        roast:[
          "–ï—Å–ª–∏ –Ω–µ –≤—ã–∫–ª–∞–¥—ã–≤–∞–µ—à—å ‚Äî —Ç—ã –Ω–µ –∞–≤—Ç–æ—Ä. –¢—ã –∑—Ä–∏—Ç–µ–ª—å.",
          "–û–¥–∏–Ω —Ä–æ–ª–∏–∫ ‚Äî —ç—Ç–æ –æ–¥–Ω–∞ –ø–æ–ø—ã—Ç–∫–∞ —É–¥–∞—á–∏.",
          "–°–µ—Ä–∏—è –ø–æ–±–µ–∂–¥–∞–µ—Ç –ø–µ—Ä—Ñ–µ–∫—Ü–∏–æ–Ω–∏–∑–º."
        ]
      }
    ];

    // Extra spice: funny taglines generator
    const TAGS = [
      "–±–µ–∑ –Ω—ã—Ç—å—è",
      "–±–µ–∑ –º–∞–≥–∏–∏",
      "–±–µ–∑ ‚Äò–∑–∞–≤—Ç—Ä–∞‚Äô",
      "–±–µ–∑ –∫–ª–æ—É–Ω–∞–¥—ã",
      "—Å –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ–º",
      "—Å –±–æ–ª—å—é, –Ω–æ —á–µ—Å—Ç–Ω–æ",
      "–∫–∞–∫ –≤–∑—Ä–æ—Å–ª—ã–π"
    ];

    const state = {
      boss: null,
      mission: null,
      startedAt: null,
      endsAt: null,
      durationHours: 24,
      checklist: [],
      points: 0,
      mode: "safe",
      theme: "mixed",
      cringe: 35
    };

    let tickInterval = null;

    function saveState(){
      localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
    }
    function loadState(){
      const raw = localStorage.getItem(STORAGE_KEY);
      if(!raw) return false;
      try{
        const s = JSON.parse(raw);
        Object.assign(state, s);
        return true;
      }catch(e){ return false; }
    }

    function toast(msg){
      const t = $("toast");
      t.textContent = msg;
      t.classList.add("show");
      setTimeout(()=> t.classList.remove("show"), 1500);
    }

    function rand(arr){ return arr[Math.floor(Math.random()*arr.length)]; }
    function clamp(n,a,b){ return Math.max(a, Math.min(b, n)); }

    function setBoss(){
      state.boss = state.boss || rand(bossNames);
      $("bossName").textContent = "BOSS: " + state.boss;
    }

    function filteredMissions(){
      const theme = state.theme;
      let pool = MISSIONS.slice();

      if(theme !== "mixed"){
        pool = pool.filter(m => m.theme === theme);
      }

      // Cringe filter: —á–µ–º –≤—ã—à–µ % ‚Äî —Ç–µ–º –º–µ–Ω–µ–µ ‚Äú–º–µ–º–Ω–æ‚Äù –∏ ‚Äú—Ä–∏—Å–∫–æ–≤–∞–Ω–Ω–æ‚Äù
      // –ú—ã –≥—Ä—É–±–æ: MEME LORD –¥–∞—ë—Ç –±–æ–ª—å—à–µ "creator/social" –∏ roast-–ª–∏–Ω–∏–π, SAFE ‚Äî –±–æ–ª–µ–µ "skills/clean/health".
      const c = state.cringe;

      if(state.mode === "meme"){
        // –º–µ–Ω—å—à–µ —Ñ–∏–ª—å—Ç—Ä–∞, –±–æ–ª—å—à–µ —à–∏–∑—ã
        if(c > 60){
          pool = pool.filter(m => m.theme !== "social"); // —á—É—Ç—å –º–µ–Ω—å—à–µ —Ä–∏—Å–∫–æ–≤
        }
      } else if(state.mode === "hard"){
        // hard = –±–æ–ª—å—à–µ skills/money/clean
        if(c > 30) pool = pool.filter(m => ["skills","money","clean","health","creator"].includes(m.theme));
      } else {
        // safe
        if(c > 25) pool = pool.filter(m => m.theme !== "social");
      }

      return pool.length ? pool : MISSIONS.slice();
    }

    function pickMission(){
      const pool = filteredMissions();

      // "–ë–µ–∑—É–º–Ω–∞—è" –¥–µ—Ç–∞–ª—å: —Å–ª–µ–≥–∫–∞ –ø–æ–¥–º–µ—à–∏–≤–∞–µ–º —Ç–µ–≥, —á—Ç–æ–±—ã –º–∏—Å—Å–∏—è –≤—ã–≥–ª—è–¥–µ–ª–∞ –∫–∞–∫ "–ø—Ä–∏–∫–∞–∑"
      const m = rand(pool);
      const tag = rand(TAGS);

      return {
        ...m,
        tag,
        // roastLine –±—É–¥–µ—Ç –≤—ã–±–∏—Ä–∞—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏
      };
    }

    function renderMission(){
      const m = state.mission;
      if(!m){
        $("mTitle").textContent = "–ü–æ–∫–∞ –ø—É—Å—Ç–æ. –ù–∞–∂–º–∏ –∫–Ω–æ–ø–∫—É.";
        $("mHook").textContent = "–°–∞–π—Ç –Ω–µ –±—É–¥–µ—Ç —Ç–µ–±—è –≤–¥–æ—Ö–Ω–æ–≤–ª—è—Ç—å. –û–Ω –±—É–¥–µ—Ç —Ç–µ–±—è —Ç–æ–ª–∫–∞—Ç—å.";
        $("metaRow").style.display = "none";
        $("timerBox").style.display = "none";
        $("progressBox").style.display = "none";
        $("statusLabel").textContent = "–≥–æ—Ç–æ–≤ –∫ –Ω–∞–∂–∞—Ç–∏—é";
        return;
      }

      $("mTitle").textContent = m.title + " ¬∑ " + "¬´" + m.tag + "¬ª";
      $("mHook").textContent = m.hook;

      $("mEta").textContent = m.eta;
      $("mDifficulty").textContent = m.difficulty;
      $("mProof").textContent = m.proof;
      $("mReality").textContent = m.reality;

      $("metaRow").style.display = "flex";
      $("progressBox").style.display = "block";

      // Checklist
      const list = $("checklist");
      list.innerHTML = "";
      m.steps.forEach((s, idx) => {
        const checked = !!state.checklist[idx];
        const div = document.createElement("div");
        div.className = "item";
        div.innerHTML = `
          <input type="checkbox" ${checked ? "checked": ""} data-idx="${idx}">
          <div>
            <b>${escapeHtml(s.t)}</b>
            <small>${escapeHtml(s.d)}</small>
          </div>
        `;
        list.appendChild(div);
      });

      // Wire checkboxes
      list.querySelectorAll('input[type="checkbox"]').forEach(cb => {
        cb.addEventListener("change", (e)=>{
          const i = Number(e.target.dataset.idx);
          state.checklist[i] = e.target.checked;

          // points system
          if(e.target.checked){
            state.points += 25;
            toast("+25 Boss Points");
          }else{
            state.points = Math.max(0, state.points - 15);
            toast("-15 (–≤–µ—Ä–Ω—É–ª —à–∞–≥ –æ–±—Ä–∞—Ç–Ω–æ)");
          }
          saveState();
          updateProgressUI();
        });
      });

      $("statusLabel").textContent = state.startedAt ? "–º–∏—Å—Å–∏—è –∏–¥—ë—Ç" : "–º–∏—Å—Å–∏—è –≥–æ—Ç–æ–≤–∞ (–∑–∞–ø—É—Å—Ç–∏ —Ç–∞–π–º–µ—Ä)";
      updateProgressUI();
      renderShareCanvas(); // keep fresh
    }

    function updateProgressUI(){
      const m = state.mission;
      if(!m) return;

      const done = state.checklist.filter(Boolean).length;
      const total = m.steps.length;
      const pct = total ? Math.round((done/total)*100) : 0;

      $("progressText").textContent = `${done}/${total} –≤—ã–ø–æ–ª–Ω–µ–Ω–æ ¬∑ ${pct}%`;
      $("fill").style.width = pct + "%";
      $("points").textContent = String(state.points);

      // roast line: —á–µ–º –º–µ–Ω—å—à–µ –ø—Ä–æ–≥—Ä–µ—Å—Å ‚Äî —Ç–µ–º –∑–ª–µ–µ
      let roast = rand(m.roast);
      if(pct >= 100){
        roast = "–ó–ê–ö–†–´–¢–û. –¢—ã —Å–¥–µ–ª–∞–ª. –¢–µ–ø–µ—Ä—å –ø–æ–∫–∞–∂–∏ –ø—Ä—É—Ñ –º–∏—Ä—É.";
      } else if(pct >= 60){
        roast = "–ù–æ—Ä–º–∞–ª—å–Ω–æ. –¢–µ–ø–µ—Ä—å –Ω–µ —Å–ª–µ–π –Ω–∞ —Ñ–∏–Ω–∏—à–µ.";
      } else if(pct >= 25){
        roast = "–¢—ã –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ. –ù–µ –¥–µ–ª–∞–π –≤–∏–¥, —á—Ç–æ —ç—Ç–æ ‚Äò–ø–æ—á—Ç–∏ —Å–¥–µ–ª–∞–Ω–æ‚Äô.";
      } else {
        roast = rand(m.roast);
      }
      $("roastLine").textContent = roast;

      // Timer box visibility
      $("timerBox").style.display = state.startedAt ? "flex" : "none";
      $("canvasWrap").style.display = "none";
    }

    function startTimer(){
      if(!state.mission){
        toast("–°–Ω–∞—á–∞–ª–∞ —Å–≥–µ–Ω–µ—Ä—å –º–∏—Å—Å–∏—é.");
        return;
      }
      if(state.startedAt){
        toast("–¢–∞–π–º–µ—Ä —É–∂–µ –∏–¥—ë—Ç.");
        return;
      }
      const hours = state.durationHours;
      state.startedAt = now();
      state.endsAt = state.startedAt + hours * 60 * 60 * 1000;
      $("statusLabel").textContent = "–º–∏—Å—Å–∏—è –∏–¥—ë—Ç";
      saveState();
      runTicker();
      toast("–¢–∞–π–º–µ—Ä –∑–∞–ø—É—â–µ–Ω. –¢–µ–ø–µ—Ä—å –±–µ–∑ –æ—Ç–º–∞–∑–æ–∫.");
    }

    function runTicker(){
      if(tickInterval) clearInterval(tickInterval);
      tickInterval = setInterval(()=>{
        if(!state.endsAt){
          $("timeLeft").textContent = "‚Äî:‚Äî:‚Äî";
          return;
        }
        const ms = state.endsAt - now();
        if(ms <= 0){
          $("timeLeft").textContent = "00:00:00";
          $("statusLabel").textContent = "–≤—Ä–µ–º—è –≤—ã—à–ª–æ (–Ω–æ –º–æ–∂–Ω–æ –¥–æ–±–∏—Ç—å)";
          // bonus: if finished, more points
          if(state.mission && state.checklist.filter(Boolean).length === state.mission.steps.length){
            // already complete
          }
          return;
        }
        $("timeLeft").textContent = formatHMS(ms);
      }, 250);
    }

    function formatHMS(ms){
      const s = Math.floor(ms/1000);
      const h = Math.floor(s/3600);
      const m = Math.floor((s%3600)/60);
      const ss = s%60;
      return String(h).padStart(2,"0")+":"+String(m).padStart(2,"0")+":"+String(ss).padStart(2,"0");
    }

    function resetAll(){
      localStorage.removeItem(STORAGE_KEY);
      Object.assign(state, {
        boss: null,
        mission: null,
        startedAt: null,
        endsAt: null,
        durationHours: 24,
        checklist: [],
        points: 0,
        mode: "safe",
        theme: "mixed",
        cringe: 35
      });
      $("postOut").value = "";
      $("doneText").value = "";
      $("resultText").value = "";
      $("pain").selectedIndex = 0;
      setBoss();
      syncControls();
      renderMission();
      runTicker();
      toast("–°–±—Ä–æ—à–µ–Ω–æ. –ß–∏—Å—Ç—ã–π –ª–∏—Å—Ç.");
    }

    function generateMission(){
      // lock: if mission running, don't override
      if(state.startedAt){
        toast("–ú–∏—Å—Å–∏—è —É–∂–µ –∏–¥—ë—Ç. –°–Ω–∞—á–∞–ª–∞ —Å–±—Ä–æ—Å –∏–ª–∏ –¥–æ–±–µ–π.");
        return;
      }
      state.mission = pickMission();
      state.checklist = new Array(state.mission.steps.length).fill(false);
      state.points = 0;
      saveState();
      renderMission();
      toast("–ú–∏—Å—Å–∏—è –ø–æ–ª—É—á–µ–Ω–∞. –ó–∞–ø—É—Å–∫–∞–π —Ç–∞–π–º–µ—Ä.");
    }

    function reroll(){
      if(state.startedAt){
        toast("–ù–µ–ª—å–∑—è —Ä–µ—Ä–æ–ª–ª–∏—Ç—å –≤–æ –≤—Ä–µ–º—è —Ç–∞–π–º–µ—Ä–∞.");
        return;
      }
      if(!state.mission){
        toast("–°–Ω–∞—á–∞–ª–∞ —Å–≥–µ–Ω–µ—Ä—å –º–∏—Å—Å–∏—é.");
        return;
      }
      generateMission();
      toast("–†–µ—Ä–æ–ª–ª. –ù–æ–≤–∞—è —Ä–µ–∞–ª—å–Ω–æ—Å—Ç—å –≤—ã–¥–∞–Ω–∞.");
    }

    function buildPost(extraSpicy=false){
      const m = state.mission;
      if(!m){
        toast("–°–Ω–∞—á–∞–ª–∞ –º–∏—Å—Å–∏—è.");
        return;
      }
      const done = $("doneText").value.trim();
      const res = $("resultText").value.trim();
      const pain = $("pain").value;

      const progress = m ? `${state.checklist.filter(Boolean).length}/${m.steps.length}` : "‚Äî";
      const pts = state.points;

      const spice1 = extraSpicy
        ? "–°–µ–≥–æ–¥–Ω—è —è –Ω–∞–∂–∞–ª –∫–Ω–æ–ø–∫—É –∏ –ø–æ–Ω—è–ª: –º–æ–∑–≥ –ª—é–±–∏—Ç –≥–æ–≤–æ—Ä–∏—Ç—å, –Ω–æ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç—å –ª—é–±–∏—Ç —á–µ–∫–±–æ–∫—Å—ã."
        : "–°–µ–≥–æ–¥–Ω—è —è –Ω–∞–∂–∞–ª –∫–Ω–æ–ø–∫—É. –ë–µ–∑ –º–æ—Ç–∏–≤–∞—Ü–∏–∏. –ü—Ä–æ—Å—Ç–æ —Å–¥–µ–ª–∞–ª.";

      const spice2 = extraSpicy
        ? "–ï—Å–ª–∏ —Ç—ã —Ç–æ–∂–µ ‚Äò–≥–æ—Ç–æ–≤–∏—à—å—Å—è‚Äô ‚Äî –ø–æ–∑–¥—Ä–∞–≤–ª—è—é, —Ç—ã –≤ —Ä–µ–∂–∏–º–µ NPC. –ñ–º–∏ –∫–Ω–æ–ø–∫—É –∏ –≤—ã–π–¥–∏ –∏–∑ –º–µ–Ω—é."
        : "–ï—Å–ª–∏ —Ç—ã —Ç–æ–∂–µ –∑–∞–ª–∏–ø–∞–µ—à—å ‚Äî –ø–æ–ø—Ä–æ–±—É–π 1 –º–∏—Å—Å–∏—é. –ù–µ —Ñ–∏–ª–æ—Å–æ—Ñ–∏—é.";

      const proofLine = m.proof.toLowerCase().includes("—Å—Å—ã–ª–∫–∞")
        ? "–ü—Ä—É—Ñ: —Å—Å—ã–ª–∫–∞/—Å–∫—Ä–∏–Ω –≥–æ—Ç–æ–≤."
        : "–ü—Ä—É—Ñ: –µ—Å—Ç—å (–Ω–µ –±—É–¥—É –≤—Ä–∞—Ç—å).";

      const msg =
`${spice1}

–ú–∏—Å—Å–∏—è: ${m.title}
–ü—Ä–æ–≥—Ä–µ—Å—Å: ${progress} ‚úÖ
–†–µ–∑—É–ª—å—Ç–∞—Ç: ${res || "–µ—Å—Ç—å –¥–≤–∏–∂–µ–Ω–∏–µ"} (${pain})
Boss Points: ${pts} ‚ö°

–ß—Ç–æ —Å–¥–µ–ª–∞–ª: ${done || "—Å–¥–µ–ª–∞–ª —à–∞–≥–∏, –Ω–µ –∫—Ä–∞—Å–∏–≤–æ, –Ω–æ —á–µ—Å—Ç–Ω–æ."}
${proofLine}

${spice2}`;

      return msg.trim();
    }

    function copy(text){
      navigator.clipboard.writeText(text).then(()=>{
        toast("–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ.");
      }).catch(()=>{
        toast("–ù–µ —Å–º–æ–≥ —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å (–±—Ä–∞—É–∑–µ—Ä).");
      });
    }

    function escapeHtml(str){
      return String(str)
        .replaceAll("&","&amp;")
        .replaceAll("<","&lt;")
        .replaceAll(">","&gt;")
        .replaceAll('"',"&quot;")
        .replaceAll("'","&#039;");
    }

    function renderShareCanvas(){
      const c = $("shareCanvas");
      const ctx = c.getContext("2d");
      const w = c.width, h = c.height;

      // background
      const g1 = ctx.createRadialGradient(w*0.2, h*0.15, 40, w*0.2, h*0.15, w*0.9);
      g1.addColorStop(0, "rgba(122,168,255,0.18)");
      g1.addColorStop(1, "rgba(0,0,0,0)");
      const g2 = ctx.createRadialGradient(w*0.85, h*0.2, 40, w*0.85, h*0.2, w*0.9);
      g2.addColorStop(0, "rgba(72,255,184,0.14)");
      g2.addColorStop(1, "rgba(0,0,0,0)");

      ctx.clearRect(0,0,w,h);
      ctx.fillStyle = "#0b0f14";
      ctx.fillRect(0,0,w,h);
      ctx.fillStyle = g1; ctx.fillRect(0,0,w,h);
      ctx.fillStyle = g2; ctx.fillRect(0,0,w,h);

      // subtle grid
      ctx.globalAlpha = 0.16;
      ctx.strokeStyle = "rgba(255,255,255,0.10)";
      ctx.lineWidth = 1;
      for(let x=60; x<w; x+=60){
        ctx.beginPath(); ctx.moveTo(x,0); ctx.lineTo(x,h); ctx.stroke();
      }
      for(let y=60; y<h; y+=60){
        ctx.beginPath(); ctx.moveTo(0,y); ctx.lineTo(w,y); ctx.stroke();
      }
      ctx.globalAlpha = 1;

      // card
      const pad = 56;
      const cardX = pad, cardY = pad, cardW = w - pad*2, cardH = h - pad*2;

      roundRect(ctx, cardX, cardY, cardW, cardH, 34, "rgba(255,255,255,0.06)", "rgba(255,255,255,0.10)");

      // header
      ctx.font = "700 28px ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace";
      ctx.fillStyle = "rgba(255,255,255,0.78)";
      ctx.fillText("BROKE ‚Üí BOSS", cardX+34, cardY+58);

      const m = state.mission;
      const boss = state.boss || "???";
      ctx.font = "600 18px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial";
      ctx.fillStyle = "rgba(255,255,255,0.62)";
      ctx.fillText("BOSS: " + boss, cardX+34, cardY+86);

      // mission title
      ctx.font = "800 40px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial";
      ctx.fillStyle = "rgba(255,255,255,0.92)";
      const title = m ? m.title : "–ù–∞–∂–º–∏ –∫–Ω–æ–ø–∫—É ‚Üí –ø–æ–ª—É—á–∏ –º–∏—Å—Å–∏—é";
      wrapText(ctx, title, cardX+34, cardY+150, cardW-68, 46);

      // progress bar
      const total = m ? m.steps.length : 1;
      const done = m ? state.checklist.filter(Boolean).length : 0;
      const pct = m ? (done/total) : 0;
      const barX = cardX+34, barY = cardY+cardH-150, barW = cardW-68, barH = 18;

      roundRect(ctx, barX, barY, barW, barH, 999, "rgba(255,255,255,0.10)", "rgba(255,255,255,0.12)");
      const grad = ctx.createLinearGradient(barX,0,barX+barW,0);
      grad.addColorStop(0, "rgba(72,255,184,0.95)");
      grad.addColorStop(0.5, "rgba(122,168,255,0.90)");
      grad.addColorStop(1, "rgba(255,184,107,0.95)");
      roundRect(ctx, barX, barY, Math.max(16, barW*pct), barH, 999, grad, "rgba(0,0,0,0)");

      // stats
      ctx.font = "700 22px ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace";
      ctx.fillStyle = "rgba(255,255,255,0.88)";
      ctx.fillText(`Progress: ${done}/${total}`, barX, barY+52);

      ctx.fillText(`Boss Points: ${state.points}`, barX+340, barY+52);

      const left = state.endsAt ? Math.max(0, state.endsAt - now()) : 0;
      const tl = state.startedAt ? formatHMS(left) : "not started";
      ctx.fillText(`Time left: ${tl}`, barX+700, barY+52);

      // footer
      ctx.font = "600 16px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial";
      ctx.fillStyle = "rgba(255,255,255,0.60)";
      ctx.fillText("–°–¥–µ–ª–∞–Ω–æ –Ω–∞ GitHub Pages ‚Ä¢ 100% local ‚Ä¢ –ù–∏–∫–∞–∫–∏—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤", barX, cardY+cardH-36);
    }

    function roundRect(ctx, x, y, w, h, r, fill, stroke){
      ctx.beginPath();
      ctx.moveTo(x+r, y);
      ctx.arcTo(x+w, y, x+w, y+h, r);
      ctx.arcTo(x+w, y+h, x, y+h, r);
      ctx.arcTo(x, y+h, x, y, r);
      ctx.arcTo(x, y, x+w, y, r);
      ctx.closePath();
      if(fill){
        ctx.fillStyle = fill;
        ctx.fill();
      }
      if(stroke){
        ctx.strokeStyle = stroke;
        ctx.lineWidth = 2;
        ctx.stroke();
      }
    }

    function wrapText(ctx, text, x, y, maxWidth, lineHeight){
      const words = String(text).split(" ");
      let line = "";
      let yy = y;
      for(let n=0; n<words.length; n++){
        const testLine = line + words[n] + " ";
        const metrics = ctx.measureText(testLine);
        if(metrics.width > maxWidth && n>0){
          ctx.fillText(line, x, yy);
          line = words[n] + " ";
          yy += lineHeight;
          if(yy > y + lineHeight*3.4){ // limit lines
            ctx.fillText("‚Ä¶", x, yy);
            return;
          }
        } else {
          line = testLine;
        }
      }
      ctx.fillText(line, x, yy);
    }

    async function shareCard(){
      renderShareCanvas();
      $("canvasWrap").style.display = "block";
      const c = $("shareCanvas");

      // Try Web Share API with file
      if(navigator.share && c.toBlob){
        c.toBlob(async (blob)=>{
          try{
            const file = new File([blob], "broke-to-boss.png", {type:"image/png"});
            await navigator.share({
              title: "BROKE ‚Üí BOSS",
              text: "–ñ–º–∏ –∫–Ω–æ–ø–∫—É ‚Üí –ø–æ–ª—É—á–∏ –º–∏—Å—Å–∏—é ‚Üí –ø—Ä—É—Ñ.",
              files: [file]
            });
            toast("–®—ç—Ä –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω.");
          }catch(e){
            toast("–®—ç—Ä –æ—Ç–º–µ–Ω—ë–Ω –∏–ª–∏ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è.");
          }
        }, "image/png");
      } else {
        toast("–û—Ç–∫—Ä—ã–ª –∫–∞—Ä—Ç–æ—á–∫—É. –°–æ—Ö—Ä–∞–Ω–∏/—Å–∫—Ä–∏–Ω–Ω–∏ –∏ –∫–∏–¥–∞–π.");
      }
    }

    function copyLink(){
      const url = location.href;
      copy(url);
    }

    function syncControls(){
      $("mode").value = state.mode;
      $("theme").value = state.theme;
      $("duration").value = String(state.durationHours);
      $("cringe").value = String(state.cringe);
      $("cringeLabel").textContent = state.cringe + "%";
      $("modeLabel").textContent =
        state.mode === "safe" ? "SAFE CHAOS" :
        state.mode === "hard" ? "HARD MODE" : "MEME LORD";
    }

    // Event wiring
    $("btnGenerate").addEventListener("click", ()=>{
      state.mode = $("mode").value;
      state.theme = $("theme").value;
      state.durationHours = Number($("duration").value);
      state.cringe = Number($("cringe").value);
      saveState();
      syncControls();
      generateMission();
      renderShareCanvas();
    });

    $("btnStart").addEventListener("click", ()=>{
      state.durationHours = Number($("duration").value);
      saveState();
      startTimer();
      updateProgressUI();
      renderShareCanvas();
    });

    $("btnReroll").addEventListener("click", ()=>{
      state.mode = $("mode").value;
      state.theme = $("theme").value;
      state.cringe = Number($("cringe").value);
      saveState();
      syncControls();
      reroll();
      renderShareCanvas();
    });

    $("btnReset").addEventListener("click", resetAll);

    $("cringe").addEventListener("input", (e)=>{
      state.cringe = Number(e.target.value);
      $("cringeLabel").textContent = state.cringe + "%";
      saveState();
    });

    $("mode").addEventListener("change", ()=>{
      state.mode = $("mode").value;
      $("modeLabel").textContent =
        state.mode === "safe" ? "SAFE CHAOS" :
        state.mode === "hard" ? "HARD MODE" : "MEME LORD";
      saveState();
    });

    $("theme").addEventListener("change", ()=>{
      state.theme = $("theme").value;
      saveState();
    });

    $("duration").addEventListener("change", ()=>{
      state.durationHours = Number($("duration").value);
      saveState();
    });

    $("btnMakePost").addEventListener("click", ()=>{
      const text = buildPost(false);
      $("postOut").value = text;
      toast("–ü–æ—Å—Ç —Å–æ–±—Ä–∞–Ω.");
    });

    $("btnMakeInsult").addEventListener("click", ()=>{
      const text = buildPost(true);
      $("postOut").value = text;
      toast("–ü–æ—Å—Ç —Å—Ç–∞–ª –∑–ª–µ–µ –∏ —Å–º–µ—à–Ω–µ–µ.");
    });

    $("btnCopyPost").addEventListener("click", ()=>{
      const t = $("postOut").value.trim();
      if(!t) return toast("–°–Ω–∞—á–∞–ª–∞ —Å–æ–±–µ—Ä–∏ –ø–æ—Å—Ç.");
      copy(t);
    });

    $("btnReport").addEventListener("click", ()=>{
      const base = buildPost(false);
      $("postOut").value = base;
      toast("–û—Ç—á—ë—Ç/–ø–æ—Å—Ç –≥–æ—Ç–æ–≤.");
    });

    $("btnShare").addEventListener("click", shareCard);
    $("btnCopyLink").addEventListener("click", copyLink);

    // Init
    (function init(){
      loadState();
      setBoss();
      syncControls();

      // If we have a mission but no boss, ensure boss exists
      if(!state.boss) setBoss();

      renderMission();
      runTicker();

      // If timer running, show it
      if(state.startedAt){
        $("timerBox").style.display = "flex";
        $("statusLabel").textContent = "–º–∏—Å—Å–∏—è –∏–¥—ë—Ç";
      }

      // Keep canvas up to date
      renderShareCanvas();
    })();
  </script>
</body>
</html>
