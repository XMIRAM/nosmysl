<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover" />
  <meta name="theme-color" content="#0B1412" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

  <title>VIRAL LINK — Arcade</title>
  <link rel="manifest" href="manifest.webmanifest" />
  <link rel="stylesheet" href="styles.css" />
</head>

<body>
  <!-- NO LANDSCAPE -->
  <div id="rotateOverlay" aria-hidden="true">
    <div class="rotateCard">
      <div class="rotateIcon">↻</div>
      <div class="rotateTitle">Только вертикально</div>
      <div class="rotateText">Поверни телефон обратно — игра строго под портрет.</div>
    </div>
  </div>

  <div class="bg">
    <div class="blob b1"></div>
    <div class="blob b2"></div>
    <div class="blob b3"></div>
    <div class="grain"></div>
  </div>

  <main class="wrap" role="application">
    <!-- GAME CANVAS -->
    <canvas id="game" class="gameCanvas" aria-label="Viral arcade game"></canvas>

    <!-- TOP HUD -->
    <div class="hud">
      <div class="hudLeft">
        <div class="pill">
          <span class="dot"></span>
          <span id="hudStatus">OFFLINE</span>
        </div>
        <div class="mini">
          <div class="k">ID</div>
          <div id="hudId" class="mono v">—</div>
        </div>
      </div>

      <div class="hudRight">
        <div class="mini">
          <div class="k">TIME</div>
          <div id="hudTime" class="mono v">30.0</div>
        </div>
        <div class="mini">
          <div class="k">SCORE</div>
          <div id="hudScore" class="mono v">0</div>
        </div>
      </div>
    </div>

    <!-- LOAD BAR -->
    <div class="loadBar">
      <div class="loadTop">
        <div class="loadTitle">VIRAL LOAD</div>
        <div id="loadPct" class="mono">0%</div>
      </div>
      <div class="bar">
        <div id="barFill" class="barFill"></div>
      </div>
    </div>

    <!-- MENU / OVERLAYS -->
    <section id="overlayMenu" class="overlay show">
      <div class="card">
        <div class="brandRow">
          <div class="logo">☣</div>
          <div>
            <div class="brand">VIRAL LINK</div>
            <div class="sub">Arcade infection experiment (virtual)</div>
          </div>
        </div>

        <h1 class="title">Играй. Набери 100%. Зарази ссылкой.</h1>
        <p class="desc">
          Ты управляешь вирус-ядром пальцем. Собирай <b>сыворотку</b>, избегай <b>антидотов</b>.
          Это игра, не реальный вирус.
        </p>

        <div class="infoGrid">
          <div class="info">
            <div class="k">Заражен от</div>
            <div id="infoFrom" class="mono v">PATIENT ZERO</div>
          </div>
          <div class="info">
            <div class="k">Длина цепочки</div>
            <div id="infoChain" class="mono v">—</div>
          </div>
        </div>

        <div class="btnRow">
          <button id="btnJoin" class="btn ghost" type="button">Получить Infection ID</button>
          <button id="btnPlay" class="btn primary" type="button">PLAY</button>
        </div>

        <div class="btnRow">
          <button id="btnTrace" class="btn" type="button">TRACE CHAIN</button>
          <button id="btnSound" class="btn" type="button">SOUND: ON</button>
        </div>

        <div class="tiny">Tip: чтобы “заразить” — надо выиграть (100%).</div>
      </div>
    </section>

    <section id="overlayWin" class="overlay">
      <div class="card">
        <div class="bigTitle">UNLOCKED ☣</div>
        <div class="desc">Ты набрал 100%. Теперь можешь отправить ссылку другу.</div>

        <div class="results">
          <div class="r">
            <div class="k">SCORE</div>
            <div id="winScore" class="mono v">0</div>
          </div>
          <div class="r">
            <div class="k">CASE</div>
            <div id="winCase" class="mono v">—</div>
          </div>
        </div>

        <div class="btnRow">
          <button id="btnShare" class="btn primary" type="button">SHARE</button>
          <button id="btnCopy" class="btn" type="button">COPY LINK</button>
        </div>

        <div class="btnRow">
          <button id="btnAgain" class="btn ghost" type="button">PLAY AGAIN</button>
          <button id="btnBack" class="btn" type="button">MENU</button>
        </div>
      </div>
    </section>

    <section id="overlayLose" class="overlay">
      <div class="card">
        <div class="bigTitle">TRY AGAIN</div>
        <div class="desc">Время вышло. Дожми до 100%.</div>

        <div class="results">
          <div class="r">
            <div class="k">SCORE</div>
            <div id="loseScore" class="mono v">0</div>
          </div>
          <div class="r">
            <div class="k">LOAD</div>
            <div id="loseLoad" class="mono v">0%</div>
          </div>
        </div>

        <div class="btnRow">
          <button id="btnRetry" class="btn primary" type="button">RETRY</button>
          <button id="btnMenu2" class="btn" type="button">MENU</button>
        </div>
      </div>
    </section>

    <section id="overlayTrace" class="overlay">
      <div class="card">
        <div class="brandRow">
          <div class="logo">⛓</div>
          <div>
            <div class="brand">TRACE CHAIN</div>
            <div class="sub">Кто от кого пошёл</div>
          </div>
        </div>

        <div class="infoGrid">
          <div class="info">
            <div class="k">Твой ID</div>
            <div id="traceMyId" class="mono v">—</div>
          </div>
          <div class="info">
            <div class="k">Т
